(()=>{"use strict";const e=window.ReactJSXRuntime;function t(e,t){if(e&&"name"in e&&e.name){const s=e.name.toLowerCase();return t.some((e=>s.endsWith(`.${e.toLowerCase()}`)))}return!1}const s=e=>{e.target.classList.remove("--is-loading")},n=e=>{e.target.classList.remove("--is-loading"),e.target.classList.add("--is-error")},a=window.React;var l;function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},i.apply(null,arguments)}var r,o=function(e){return a.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},e),l||(l=a.createElement("path",{d:"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7l233.4-233.3c12.5-12.5 32.8-12.5 45.3 0z"})))};function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},c.apply(null,arguments)}var d,m=function(e){return a.createElement("svg",c({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},e),r||(r=a.createElement("path",{d:"M80 104c13.3 0 24-10.7 24-24S93.3 56 80 56 56 66.7 56 80s10.7 24 24 24m80-24c0 32.8-19.7 61-48 73.3v87.8c18.8-10.9 40.7-17.1 64-17.1h96c35.3 0 64-28.7 64-64v-6.7c-28.3-12.3-48-40.5-48-73.3 0-44.2 35.8-80 80-80s80 35.8 80 80c0 32.8-19.7 61-48 73.3v6.7c0 70.7-57.3 128-128 128h-96c-35.3 0-64 28.7-64 64v6.7c28.3 12.3 48 40.5 48 73.3 0 44.2-35.8 80-80 80S0 476.2 0 432c0-32.8 19.7-61 48-73.3V153.3C19.7 141 0 112.8 0 80 0 35.8 35.8 0 80 0s80 35.8 80 80m232 0c0-13.3-10.7-24-24-24s-24 10.7-24 24 10.7 24 24 24 24-10.7 24-24M80 456c13.3 0 24-10.7 24-24s-10.7-24-24-24-24 10.7-24 24 10.7 24 24 24"})))};function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},u.apply(null,arguments)}var p=function(e){return a.createElement("svg",u({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 512"},e),d||(d=a.createElement("path",{d:"M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9S63.9 115 63.9 128v256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"})))};function h({attachment:s}){let n=(0,e.jsx)("p",{className:"fallback fallback-error",children:"Failed to load attachment"});return!1===("_ptc_view_url"in s&&s._ptc_view_url&&"name"in s&&s.name)?window.console.error("Could not display AttachmentThumbnail for attachment with missing data.",s):function(e){return t(e,["jpg","jpeg","png","bmp","gif"])}(s)?n=(0,e.jsx)("img",{src:s._ptc_view_url,alt:s.name,draggable:"false"}):function(e){return t(e,["mp4"])}(s)?n=(0,e.jsx)("video",{src:s._ptc_view_url,controls:!0,width:"100%",height:"auto"}):t(s,["pdf"])?n=(0,e.jsx)("object",{data:s._ptc_view_url,type:"application/pdf",width:"100%",height:"600px",children:(0,e.jsxs)("p",{className:"fallback fallback-warning",children:["Download ",(0,e.jsx)("a",{href:s._ptc_view_url,download:s.name,children:s.name})," to view"]})}):"_ptc_oembed_html"in s&&s._ptc_oembed_html?n=(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:s._ptc_oembed_html}}):(window.console.warn("Could not display AttachmentThumbnail for unsupported attachment:",s),n=(0,e.jsxs)("p",{className:"fallback fallback-warning",children:["Failed to display unsupported attachment ",(0,e.jsx)("em",{children:s.name})]})),(0,e.jsx)("div",{className:"ptc-AttachmentThumbnail",children:n})}const{useState:g,useEffect:w,useRef:f}=wp.element;function v({task:t,rowNumber:a=null,tagName:l="li"}){const[i,r]=g(!1),c=f(null);w((()=>{c.current&&function(e){for(let t of e.querySelectorAll("img:not(.load-monitoring-disabled)"))"complete"in t&&!1===t.complete&&(t.classList.add("--is-loading"),t.addEventListener("load",s),t.addEventListener("error",n));for(let t of e.querySelectorAll("video:not(.load-monitoring-disabled)"))"readyState"in t&&t.readyState<2&&(t.classList.add("--is-loading"),t.addEventListener("loadeddata",s),t.addEventListener("error",n));for(let t of e.querySelectorAll('object[type="application/pdf"]:not(.load-monitoring-disabled)'))navigator?.mimeTypes["application/pdf"]?.enabledPlugin||navigator.pdfViewerEnabled?"contentDocument"in t&&null!==t.contentDocument&&(t.classList.add("--is-loading"),t.addEventListener("load",s),t.addEventListener("error",n)):t.classList.add("--is-error")}(c.current)}),[c.current,i]);let d="",u=!1,x=!1,j=null;if("completed"in t){const[s,n]=function(e){let t=null,s=null;return e&&"completed"in e&&(s="Incomplete",!0===e.completed&&(s="Completed"),t=e.completed),[t,s]}(t);j=(0,e.jsx)("div",{className:"completed","data-completed":s,children:(0,e.jsx)(o,{"aria-label":n,preserveAspectRatio:"xMidYMid meet"})})}let _=null,b=null;if("subtasks"in t){u=!0;let s=null;const n=function(e){let t=[];return e&&"subtasks"in e&&e.subtasks&&Array.isArray(e.subtasks)&&(t=e.subtasks),t}(t);n.length>0&&(x=!0,s=(0,e.jsxs)(e.Fragment,{children:[n.length,(0,e.jsx)(m,{"aria-label":"Subtasks",style:{transform:"rotate(90deg)"},preserveAspectRatio:"xMidYMid meet"})]}),b=(0,e.jsxs)("div",{className:"subtasks",children:[(0,e.jsx)("p",{className:"small-label",children:"Subtasks"}),(0,e.jsx)("ol",{className:"tasks",children:n.map(((t,s)=>{const{subtasks:n,...a}=t;return(0,e.jsx)(v,{task:a,rowNumber:s+1},JSON.stringify(a))}))})]})),_=(0,e.jsx)("p",{className:"subtask-count",children:s})}let k=null;var N;"name"in t&&(k=(0,e.jsx)("p",{className:"task-name",children:null!==(N=t.name)&&void 0!==N?N:""}));let y=null;if("assignee"in t){const[s,n]=function(e){let t=null,s=null;return e&&"assignee"in e&&e.assignee&&("name"in e.assignee&&e.assignee.name&&(t=e.assignee.name),"photo"in e.assignee&&e.assignee.photo&&"image_36x36"in e.assignee.photo&&e.assignee.photo.image_36x36&&(s=e.assignee.photo.image_36x36)),[t,s]}(t);y=(0,e.jsxs)("p",{className:"assignee",children:[n&&(0,e.jsx)("img",{className:"load-monitoring-disabled",src:n,width:"36",height:"36"}),s&&(0,e.jsx)("span",{className:"assignee-name",children:s})]})}let L=null;if("due_on"in t){const s=function(e){let t=null;return e&&"due_on"in e&&e.due_on&&(t=e.due_on),t}(t);L=(0,e.jsx)("p",{className:"due",children:s&&(S=s,S.includes("T")?new Date(S).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}):new Date(S).toLocaleDateString(void 0,{month:"short",day:"numeric",timeZone:"UTC"}))})}var S;let A=null;if("html_notes"in t){u=!0;const s=function(e){let t=null;return e&&"html_notes"in e&&e.html_notes&&(t=e.html_notes),t}(t);s&&(x=!0,A=(0,e.jsxs)("div",{className:"task-notes",children:[(0,e.jsx)("p",{className:"small-label",children:"Description"}),(0,e.jsx)("div",{className:"description",dangerouslySetInnerHTML:{__html:s}})]}))}let C=null;if("attachments"in t){u=!0;let s=function(e){let t=[];return e&&"attachments"in e&&e.attachments&&Array.isArray(e.attachments)&&e.attachments.length>0&&(t=e.attachments),t}(t);s.length>0&&(x=!0,C=(0,e.jsxs)("div",{className:"task-attachments",children:[(0,e.jsx)("p",{className:"small-label",children:"Attachments"}),(0,e.jsx)("ul",{className:"attachments-list",children:s.map((t=>(0,e.jsx)("li",{children:(0,e.jsx)(h,{attachment:t})},JSON.stringify(t))))})]}))}let E=null;if("html_notes"in t){u=!0;const s=function(e){let t=[];return e&&"tags"in e&&e.tags&&Array.isArray(e.tags)&&(t=e.tags),t.length>0&&t.sort(((e,t)=>e.name.localeCompare(t.name))),t}(t);s.length>0&&(x=!0,E=(0,e.jsxs)("div",{className:"task-tags",children:[(0,e.jsx)("p",{className:"small-label",children:"Tags"}),(0,e.jsx)("ol",{className:"tags-list",children:s.map(((t,s)=>(0,e.jsx)("li",{className:"--has-asana-palette-color-"+t.color,children:t.name},JSON.stringify(t))))})]}))}u=window.Completionist.hooks.applyFilters("TaskListItem_if_render_toggle",u,t),x=window.Completionist.hooks.applyFilters("TaskListItem_if_allow_toggle",x,t);let T=null;if(u){let t=null;x&&(d+=" --can-expand",t=(0,e.jsx)(p,{preserveAspectRatio:"xMidYMid meet"})),T=(0,e.jsx)("div",{className:"toggle",children:t})}let M=null;if(i){d+=" --is-expanded";const s=window.Completionist.hooks.applyFilters("TaskListItem_content_after_description",[],t);M=(0,e.jsxs)("div",{className:"expanded-details",children:[a&&(0,e.jsx)("div",{className:"spacer row-number"}),T&&(0,e.jsx)("div",{className:"spacer toggle"}),j&&(0,e.jsx)("div",{className:"spacer completed"}),(0,e.jsxs)("div",{className:"details",children:[E,A,s,b,C]})]})}const O=window.Completionist.hooks.applyFilters("TaskListItem_main_row_content",[k,_,y,L],t);return(0,e.jsxs)(l,{className:"ptc-TaskListItem"+d,ref:c,children:[(0,e.jsxs)("div",{className:"main",onClick:x?()=>r(!i):void 0,children:[a&&(0,e.jsx)("div",{className:"row-number",children:a}),T,j,(0,e.jsx)("div",{className:"body",children:O})]}),M]})}const x=window.wp.element;function j({src:t}){const[s,n]=(0,x.useState)("idle"),[a,l]=(0,x.useState)(null);(0,x.useEffect)((()=>{"idle"===s&&null===a&&("string"==typeof t?(n("loading"),window.fetch(t).then((e=>200!==e.status?Promise.reject(`Error ${e.status}. Failed to load task.`):e.json())).then((e=>(l(e),n("success"),Promise.resolve()))).catch((e=>{n(e),l(null)}))):"object"==typeof t?(l(t),n("success")):(n("Failed to load task due to an unexpected error."),l(null),window.console.warn("Unsupported TaskSingleAsync[src] type:",t)))}),[]);let i=null;switch(s){case"success":a&&(i=(0,e.jsx)(v,{tagName:"div",task:a}));break;case"loading":i=(0,e.jsx)("p",{className:"ptc-loader",children:"Loading task..."});break;case"error":i=(0,e.jsx)("p",{className:"ptc-error",children:"Failed to load task."});break;case"idle":i=null;break;default:i=(0,e.jsx)("p",{className:"ptc-error",children:s})}return(0,e.jsx)("div",{className:"ptc-TaskSingleAsync",children:i})}const _=window.wp.hooks;"Completionist"in window&&void 0!==window.Completionist||(window.Completionist={hooks:(0,_.createHooks)()}),document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".ptc-shortcode.ptc-asana-task[data-src]").forEach((t=>{if(t.dataset.src){const s=window.Completionist.hooks.applyFilters("shortcodes_ptc_asana_task_render",(0,e.jsx)(j,{src:t.dataset.src}),t);(0,x.createRoot)(t).render(s)}}))}))})();