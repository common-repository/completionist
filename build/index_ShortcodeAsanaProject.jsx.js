(()=>{"use strict";function e(e){return e.includes("T")?new Date(e).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}):new Date(e).toLocaleDateString(void 0,{month:"short",day:"numeric",timeZone:"UTC"})}const t=window.React;var s;function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},n.apply(null,arguments)}var a=function(e){return t.createElement("svg",n({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},e),s||(s=t.createElement("path",{d:"M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7l233.4-233.3c12.5-12.5 32.8-12.5 45.3 0z"})))};const l=window.ReactJSXRuntime;function i({color:t,color_label:s,created_at:n,html_text:i,title:r}){let c=null;if(s){let e="";t&&(e+=` --is-${t}`),c=(0,l.jsxs)("div",{className:"status-badge"+e,children:["complete"===t&&(0,l.jsx)(a,{preserveAspectRatio:"xMidYMid meet"}),s]})}let o=null;r&&(o=(0,l.jsx)("h3",{className:"title",children:r}));let d=null;if(n){const t=e(n);d=(0,l.jsxs)("p",{className:"created",children:[(0,l.jsx)("span",{children:"Updated"}),t]})}let m=null;return i&&(m=(0,l.jsx)("div",{className:"description",dangerouslySetInnerHTML:{__html:i}})),(0,l.jsxs)("div",{className:"ptc-ProjectStatus",children:[(c||d)&&(0,l.jsxs)("div",{className:"header-meta",children:[c,d]}),o,m]})}function r({completed_at:t,current_status:s,due_on:n,html_notes:a,modified_at:r,name:c}){let o=null;c&&(o=(0,l.jsx)("h2",{className:"project-name",children:c}));let d=null;a&&(d=(0,l.jsx)("div",{className:"description",dangerouslySetInnerHTML:{__html:a}}));let m=null;if(n){const e=new Date(n).toLocaleDateString(void 0,{dateStyle:"full",timeZone:"UTC"});m=(0,l.jsxs)("p",{className:"due",children:[(0,l.jsx)("span",{children:"Due"}),e]})}let u=null;if(r){const t=e(r);u=(0,l.jsxs)("p",{className:"modified",children:[(0,l.jsx)("span",{children:"Modified"}),t]})}let p=null;if(t){const s=e(t);p=(0,l.jsxs)("p",{className:"completed",children:[(0,l.jsx)("span",{children:"Completed"}),s]})}let h=null;return s&&(h=(0,l.jsx)(i,{...s})),(0,l.jsxs)("div",{className:"ptc-ProjectDetails",children:[o,(m||p||u)&&(0,l.jsxs)("div",{className:"metadata-badges",children:[m,p,u]}),d,h]})}function c(e,t){if(e&&"name"in e&&e.name){const s=e.name.toLowerCase();return t.some((e=>s.endsWith(`.${e.toLowerCase()}`)))}return!1}const o=e=>{e.target.classList.remove("--is-loading")},d=e=>{e.target.classList.remove("--is-loading"),e.target.classList.add("--is-error")};var m;function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},u.apply(null,arguments)}var p,h=function(e){return t.createElement("svg",u({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},e),m||(m=t.createElement("path",{d:"M80 104c13.3 0 24-10.7 24-24S93.3 56 80 56 56 66.7 56 80s10.7 24 24 24m80-24c0 32.8-19.7 61-48 73.3v87.8c18.8-10.9 40.7-17.1 64-17.1h96c35.3 0 64-28.7 64-64v-6.7c-28.3-12.3-48-40.5-48-73.3 0-44.2 35.8-80 80-80s80 35.8 80 80c0 32.8-19.7 61-48 73.3v6.7c0 70.7-57.3 128-128 128h-96c-35.3 0-64 28.7-64 64v6.7c28.3 12.3 48 40.5 48 73.3 0 44.2-35.8 80-80 80S0 476.2 0 432c0-32.8 19.7-61 48-73.3V153.3C19.7 141 0 112.8 0 80 0 35.8 35.8 0 80 0s80 35.8 80 80m232 0c0-13.3-10.7-24-24-24s-24 10.7-24 24 10.7 24 24 24 24-10.7 24-24M80 456c13.3 0 24-10.7 24-24s-10.7-24-24-24-24 10.7-24 24 10.7 24 24 24"})))};function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},g.apply(null,arguments)}var j=function(e){return t.createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 512"},e),p||(p=t.createElement("path",{d:"M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9S63.9 115 63.9 128v256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"})))};function x({attachment:e}){let t=(0,l.jsx)("p",{className:"fallback fallback-error",children:"Failed to load attachment"});return!1===("_ptc_view_url"in e&&e._ptc_view_url&&"name"in e&&e.name)?window.console.error("Could not display AttachmentThumbnail for attachment with missing data.",e):function(e){return c(e,["jpg","jpeg","png","bmp","gif"])}(e)?t=(0,l.jsx)("img",{src:e._ptc_view_url,alt:e.name,draggable:"false"}):function(e){return c(e,["mp4"])}(e)?t=(0,l.jsx)("video",{src:e._ptc_view_url,controls:!0,width:"100%",height:"auto"}):c(e,["pdf"])?t=(0,l.jsx)("object",{data:e._ptc_view_url,type:"application/pdf",width:"100%",height:"600px",children:(0,l.jsxs)("p",{className:"fallback fallback-warning",children:["Download ",(0,l.jsx)("a",{href:e._ptc_view_url,download:e.name,children:e.name})," to view"]})}):"_ptc_oembed_html"in e&&e._ptc_oembed_html?t=(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:e._ptc_oembed_html}}):(window.console.warn("Could not display AttachmentThumbnail for unsupported attachment:",e),t=(0,l.jsxs)("p",{className:"fallback fallback-warning",children:["Failed to display unsupported attachment ",(0,l.jsx)("em",{children:e.name})]})),(0,l.jsx)("div",{className:"ptc-AttachmentThumbnail",children:t})}const{useState:f,useEffect:v,useRef:w}=wp.element;function _({task:t,rowNumber:s=null,tagName:n="li"}){const[i,r]=f(!1),c=w(null);v((()=>{c.current&&function(e){for(let t of e.querySelectorAll("img:not(.load-monitoring-disabled)"))"complete"in t&&!1===t.complete&&(t.classList.add("--is-loading"),t.addEventListener("load",o),t.addEventListener("error",d));for(let t of e.querySelectorAll("video:not(.load-monitoring-disabled)"))"readyState"in t&&t.readyState<2&&(t.classList.add("--is-loading"),t.addEventListener("loadeddata",o),t.addEventListener("error",d));for(let t of e.querySelectorAll('object[type="application/pdf"]:not(.load-monitoring-disabled)'))navigator?.mimeTypes["application/pdf"]?.enabledPlugin||navigator.pdfViewerEnabled?"contentDocument"in t&&null!==t.contentDocument&&(t.classList.add("--is-loading"),t.addEventListener("load",o),t.addEventListener("error",d)):t.classList.add("--is-error")}(c.current)}),[c.current,i]);let m="",u=!1,p=!1,g=null;if("completed"in t){const[e,s]=function(e){let t=null,s=null;return e&&"completed"in e&&(s="Incomplete",!0===e.completed&&(s="Completed"),t=e.completed),[t,s]}(t);g=(0,l.jsx)("div",{className:"completed","data-completed":e,children:(0,l.jsx)(a,{"aria-label":s,preserveAspectRatio:"xMidYMid meet"})})}let N=null,b=null;if("subtasks"in t){u=!0;let e=null;const s=function(e){let t=[];return e&&"subtasks"in e&&e.subtasks&&Array.isArray(e.subtasks)&&(t=e.subtasks),t}(t);s.length>0&&(p=!0,e=(0,l.jsxs)(l.Fragment,{children:[s.length,(0,l.jsx)(h,{"aria-label":"Subtasks",style:{transform:"rotate(90deg)"},preserveAspectRatio:"xMidYMid meet"})]}),b=(0,l.jsxs)("div",{className:"subtasks",children:[(0,l.jsx)("p",{className:"small-label",children:"Subtasks"}),(0,l.jsx)("ol",{className:"tasks",children:s.map(((e,t)=>{const{subtasks:s,...n}=e;return(0,l.jsx)(_,{task:n,rowNumber:t+1},JSON.stringify(n))}))})]})),N=(0,l.jsx)("p",{className:"subtask-count",children:e})}let k=null;var y;"name"in t&&(k=(0,l.jsx)("p",{className:"task-name",children:null!==(y=t.name)&&void 0!==y?y:""}));let L=null;if("assignee"in t){const[e,s]=function(e){let t=null,s=null;return e&&"assignee"in e&&e.assignee&&("name"in e.assignee&&e.assignee.name&&(t=e.assignee.name),"photo"in e.assignee&&e.assignee.photo&&"image_36x36"in e.assignee.photo&&e.assignee.photo.image_36x36&&(s=e.assignee.photo.image_36x36)),[t,s]}(t);L=(0,l.jsxs)("p",{className:"assignee",children:[s&&(0,l.jsx)("img",{className:"load-monitoring-disabled",src:s,width:"36",height:"36"}),e&&(0,l.jsx)("span",{className:"assignee-name",children:e})]})}let S=null;if("due_on"in t){const s=function(e){let t=null;return e&&"due_on"in e&&e.due_on&&(t=e.due_on),t}(t);S=(0,l.jsx)("p",{className:"due",children:s&&e(s)})}let C=null;if("html_notes"in t){u=!0;const e=function(e){let t=null;return e&&"html_notes"in e&&e.html_notes&&(t=e.html_notes),t}(t);e&&(p=!0,C=(0,l.jsxs)("div",{className:"task-notes",children:[(0,l.jsx)("p",{className:"small-label",children:"Description"}),(0,l.jsx)("div",{className:"description",dangerouslySetInnerHTML:{__html:e}})]}))}let T=null;if("attachments"in t){u=!0;let e=function(e){let t=[];return e&&"attachments"in e&&e.attachments&&Array.isArray(e.attachments)&&e.attachments.length>0&&(t=e.attachments),t}(t);e.length>0&&(p=!0,T=(0,l.jsxs)("div",{className:"task-attachments",children:[(0,l.jsx)("p",{className:"small-label",children:"Attachments"}),(0,l.jsx)("ul",{className:"attachments-list",children:e.map((e=>(0,l.jsx)("li",{children:(0,l.jsx)(x,{attachment:e})},JSON.stringify(e))))})]}))}let A=null;if("html_notes"in t){u=!0;const e=function(e){let t=[];return e&&"tags"in e&&e.tags&&Array.isArray(e.tags)&&(t=e.tags),t.length>0&&t.sort(((e,t)=>e.name.localeCompare(t.name))),t}(t);e.length>0&&(p=!0,A=(0,l.jsxs)("div",{className:"task-tags",children:[(0,l.jsx)("p",{className:"small-label",children:"Tags"}),(0,l.jsx)("ol",{className:"tags-list",children:e.map(((e,t)=>(0,l.jsx)("li",{className:"--has-asana-palette-color-"+e.color,children:e.name},JSON.stringify(e))))})]}))}u=window.Completionist.hooks.applyFilters("TaskListItem_if_render_toggle",u,t),p=window.Completionist.hooks.applyFilters("TaskListItem_if_allow_toggle",p,t);let E=null;if(u){let e=null;p&&(m+=" --can-expand",e=(0,l.jsx)(j,{preserveAspectRatio:"xMidYMid meet"})),E=(0,l.jsx)("div",{className:"toggle",children:e})}let M=null;if(i){m+=" --is-expanded";const e=window.Completionist.hooks.applyFilters("TaskListItem_content_after_description",[],t);M=(0,l.jsxs)("div",{className:"expanded-details",children:[s&&(0,l.jsx)("div",{className:"spacer row-number"}),E&&(0,l.jsx)("div",{className:"spacer toggle"}),g&&(0,l.jsx)("div",{className:"spacer completed"}),(0,l.jsxs)("div",{className:"details",children:[A,C,e,b,T]})]})}const O=window.Completionist.hooks.applyFilters("TaskListItem_main_row_content",[k,N,L,S],t);return(0,l.jsxs)(n,{className:"ptc-TaskListItem"+m,ref:c,children:[(0,l.jsxs)("div",{className:"main",onClick:p?()=>r(!i):void 0,children:[s&&(0,l.jsx)("div",{className:"row-number",children:s}),E,g,(0,l.jsx)("div",{className:"body",children:O})]}),M]})}function N({name:e,tasks:t}){let s=null;e&&(s=(0,l.jsx)("h3",{className:"section-name",children:e}));let n=null;return n=t&&t.length>0?(0,l.jsx)("ol",{className:"tasks",children:t.map(((e,t)=>(0,l.jsx)(_,{task:e,rowNumber:t+1},JSON.stringify(e))))}):(0,l.jsx)("p",{className:"ptc-no-results",children:"No tasks"}),(0,l.jsxs)("div",{className:"ptc-ProjectSection",children:[s,n]})}const{useEffect:b,useState:k}=wp.element;function y({src:e}){const[t,s]=k("idle"),[n,a]=k(null);b((()=>{"idle"===t&&null===n&&("string"==typeof e?(s("loading"),window.fetch(e).then((e=>200!==e.status?Promise.reject(`Error ${e.status}. Failed to load project.`):e.json())).then((e=>(a(e),s("success"),Promise.resolve()))).catch((e=>{s(e),a(null)}))):"object"==typeof e?(a(e),s("success")):(s("Failed to load project due to an unexpected error."),a(null),window.console.warn("Unsupported ProjectTaskList[src] type:",e)))}),[]);const{sections:i=null,...c}=null!=n?n:{};let o=null;switch(t){case"success":i&&(o=(0,l.jsx)("div",{className:"sections-of-tasks",children:i.map((e=>(0,l.jsx)(N,{...e},JSON.stringify(e))))}));break;case"loading":o=(0,l.jsx)("p",{className:"ptc-loader",children:"Loading project..."});break;case"error":o=(0,l.jsx)("p",{className:"ptc-error",children:"Failed to load project."});break;case"idle":o=null;break;default:o=(0,l.jsx)("p",{className:"ptc-error",children:t})}return(0,l.jsxs)("div",{className:"ptc-ProjectTaskList",children:[c&&(0,l.jsx)(r,{...c}),o]})}const L=window.wp.hooks,S=window.wp.element;"Completionist"in window&&void 0!==window.Completionist||(window.Completionist={hooks:(0,L.createHooks)()}),document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".ptc-shortcode.ptc-asana-project[data-src]").forEach((e=>{if(e.dataset.src){const t=window.Completionist.hooks.applyFilters("shortcodes_ptc_asana_project_render",(0,l.jsx)(y,{src:e.dataset.src}),e);(0,S.createRoot)(e).render(t)}}))}))})();